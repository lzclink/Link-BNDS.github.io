<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"link-bnds.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="website">
<meta property="og:title" content="Link LZCのBlog">
<meta property="og:url" content="https://link-bnds.github.io/index.html">
<meta property="og:site_name" content="Link LZCのBlog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Link LZC">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://link-bnds.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Link LZCのBlog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Link LZCのBlog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Accumulation</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Link LZC"
      src="/images/rin.png">
  <p class="site-author-name" itemprop="name">Link LZC</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Link-BNDS" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Link-BNDS" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/31118078" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;31118078" rel="noopener" target="_blank">Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kpl12345yh@163.com" title="E-Mail → mailto:kpl12345yh@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-02-18 22:03:52" itemprop="dateCreated datePublished" datetime="2023-02-18T22:03:52+08:00">2023-02-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-08-22 12:49:36" itemprop="dateModified" datetime="2021-08-22T12:49:36+08:00">2021-08-22</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>hello world</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/APCSA-Practice/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/APCSA-Practice/" class="post-title-link" itemprop="url">APCSA_Practice</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-08-25 21:44:09 / Modified: 21:57:39" itemprop="dateCreated datePublished" datetime="2022-08-25T21:44:09+08:00">2022-08-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>We developed an cross-platform, integrated, and graphical Java app based on JavaFX for BNDSer to practice AP CSA FRQs. </p>
<p>You can download the release at <a target="_blank" rel="noopener" href="https://github.com/Link-BNDS/CSA_Practice_APP/releases/tag/AP">https://github.com/Link-BNDS/CSA_Practice_APP/releases/tag/AP</a>   .  You can also find the src at repo <a target="_blank" rel="noopener" href="https://github.com/Link-BNDS/CSA_Practice_APP">https://github.com/Link-BNDS/CSA_Practice_APP</a>.</p>
<p>The description can also be found at that repo.  </p>
<p>Thanks for your support. </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/Logistic-Regression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Logistic-Regression/" class="post-title-link" itemprop="url">Logistic_Regression</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-07-28 23:28:23 / Modified: 23:44:51" itemprop="dateCreated datePublished" datetime="2022-07-28T23:28:23+08:00">2022-07-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h3><p>在Coursera上吴恩达的Machine Learning中，Logistic Regression作为初学者们接触到的第二个模型，其本身是非常重要的。但是在课程当中其损失函数的梯度公式则被一笔带过。而很多人都对其为什么与线性回归的损失函数梯度是一样的表示好奇，因此，我特地从头推导了这一式子。</p>
<h3 id="2-逻辑斯蒂回归损失函数梯度推导"><a href="#2-逻辑斯蒂回归损失函数梯度推导" class="headerlink" title="2. 逻辑斯蒂回归损失函数梯度推导"></a>2. 逻辑斯蒂回归损失函数梯度推导</h3><h4 id="2-1-Introduction"><a href="#2-1-Introduction" class="headerlink" title="2.1. Introduction"></a>2.1. Introduction</h4><p>The “Machine Learning” course on Coursera is a one of the most popular course over all of MOOC. This course is famous for its simplified teaching step and other bright spots. Logistics regression, as the most important model for beginner, lacks appropriate detailed derivation of formula. In this blog, I am going to expound this section step by step.</p>
<h4 id="2-2-Logistic-Regression"><a href="#2-2-Logistic-Regression" class="headerlink" title="2.2. Logistic Regression"></a>2.2. Logistic Regression</h4><p>I think most of you have already got familiar with logistic regression.</p>
<h4 id="2-3-Cost-Function"><a href="#2-3-Cost-Function" class="headerlink" title="2.3. Cost Function"></a>2.3. Cost Function</h4><p>As we all know, the cost function of the logistic regression is modified from the one from linear regression model.</p>
<script type="math/tex; mode=display">
Cost\left( h_{\theta}\left( x \right) ,y \right) =\left\{ \begin{aligned}
    -\log \left( h_{\theta}\left( x \right) \right) \,\,   if\,\,y&=1\\
    -\log \left( 1-h_{\theta}\left( x \right) \right) \,\, if\,\,y&=0\\
\end{aligned} \right.</script><p>To simplify this function, we can write it as</p>
<script type="math/tex; mode=display">
J\left( \theta \right) =\frac{1}{2m}\sum_{i=1}^m{Cost\left( h_{\theta}\left( x^{\left( i \right)} \right) ,y^{\left( i \right)} \right)}</script><p>which</p>
<script type="math/tex; mode=display">
Cost\left( h_{\theta}\left( x^{\left( i \right)} \right) ,y^{\left( i \right)} \right) =-y^{\left( i \right)}\log \left( h_{\theta}\left( x \right) \right) -\left( 1-y^{\left( i \right)} \right) \log \left( 1-h_{\theta}\left( x^{\left( i \right)} \right) \right)</script><h4 id="2-4-Gradient-of-Cost-Function"><a href="#2-4-Gradient-of-Cost-Function" class="headerlink" title="2.4. Gradient of Cost Function"></a>2.4. Gradient of Cost Function</h4><p>And next, is the part I want to expound. Andrew, in this MOOC, just briefly introduce that the gradient of the new cost function is the same as the one for linear regression. There is no explicit derivation here. </p>
<p>For cost function $J$, we can write it as</p>
<p>\begin{equation}<br>\begin{aligned}<br>J\left( \theta \right) &amp;=-\frac{1}{m}\left[ \sum<em>{i=1}^m{-y^{\left( i \right)}\log \left( h</em>{\theta}\left( x \right) \right) -\left( 1-y^{\left( i \right)} \right) \log \left( 1-h<em>{\theta}\left( x^{\left( i \right)} \right) \right)} \right]<br>\<br>\frac{\partial}{\partial \theta _j}J\left( \theta \right) &amp;=\frac{\partial}{\partial \theta _j}\left[ -\frac{1}{m}\left[ \sum</em>{i=1}^m{-y^{\left( i \right)}\log \left( h<em>{\theta}\left( x \right) \right) -\left( 1-y^{\left( i \right)} \right) \log \left( 1-h</em>{\theta}\left( x^{\left( i \right)} \right) \right)} \right] \right]<br>\<br>&amp;=-\frac{1}{m}\left[ \sum<em>{i=1}^m{\left( y^{\left( i \right)}\frac{1}{h</em>{\theta}\left( x^{\left( i \right)} \right)}\cdot \frac{\partial}{\partial \theta <em>j}h</em>{\theta}\left( x^{\left( i \right)} \right) +\left( 1-y^{\left( i \right)} \right) \cdot \frac{1}{1-h<em>{\theta}\left( x^{\left( i \right)} \right)}\cdot \frac{\partial}{\partial \theta _j}\left( -h</em>{\theta}\left( x^{\left( i \right)} \right) \right) \right)} \right]<br>\<br>&amp;=-\frac{1}{m}\left[ \sum<em>{i=1}^m{\left( y^{\left( i \right)}\frac{1}{h</em>{\theta}\left( x^{\left( i \right)} \right)}-\left( 1-y^{\left( i \right)} \right) \cdot \frac{1}{1-h<em>{\theta}\left( x^{\left( i \right)} \right)} \right) \cdot \frac{\partial}{\partial \theta _j}\left( h</em>{\theta}\left( x^{\left( i \right)} \right) \right)} \right]<br>\<br>&amp;=-\frac{1}{m}\left[ \sum_{i=1}^m{\left( y^{\left( i \right)}\frac{1}{g\left( \theta ^Tx \right)}-\left( 1-y^{\left( i \right)} \right) \cdot \frac{1}{1-g\left( \theta ^Tx \right)} \right) \cdot \frac{\partial}{\partial \theta _j}\left( g\left( \theta ^Tx \right) \right)} \right] </p>
<p>\end{aligned}<br>\end{equation}</p>
<p>In logistic regression, we use the logistic function as our decision function. Therefore, (Mentioned: $T$ refers to transpose)</p>
<p>\begin{equation}<br>    \begin{aligned}<br>\frac{\partial}{\partial \theta _j}g\left( \theta ^Tx \right) &amp;=\frac{\partial}{\partial \theta _j}\cdot \frac{1}{1+e^{-\theta ^Tx}}<br>\<br>&amp;=\frac{\partial}{\partial \theta _j}\left( 1+e^{-\theta ^Tx} \right) ^{-1}<br>\<br>&amp;=-\left( 1+e^{-\theta ^Tx} \right) ^{-2}\cdot e^{e^{-\theta ^Tx}}\cdot x<br>\<br>&amp;=-\frac{e^{e^{-\theta ^Tx}}\cdot -x}{\left( 1+e^{e^{-\theta ^Tx}} \right) ^2}<br>    \end{aligned}<br>\end{equation}</p>
<p>We set $k=e^{-\theta ^Tx}$, plug it in,</p>
<p>\begin{equation}<br>    \begin{aligned}<br>&amp;=\frac{k}{\left( 1+k \right) ^2}\cdot x<br>\<br>&amp;=\left( \frac{1}{1+k}\cdot \frac{1+k-1}{1+k} \right) \cdot x<br>\<br>&amp;=\left[ \frac{1}{1+k}\cdot \left( 1-\frac{1}{1+k} \right) \right] \cdot x<br>    \end{aligned}<br>\end{equation}</p>
<p>Bring it back, we can see we construct the logistic function itself,</p>
<p>\begin{equation}<br>    \begin{aligned}<br>    &amp;=\left[ \frac{1}{1+e^{-\theta ^Tx}}\cdot \left( 1-\frac{1}{1+e^{-\theta ^Tx}} \right) \right] \cdot x<br>    \end{aligned}<br>\end{equation}</p>
<p>Thus, we can use the logistic function to simplify the eqution,</p>
<p>\begin{equation}<br>    \begin{aligned}<br>&amp;=\left[ \frac{1}{1+e^{-\theta ^Tx}}\cdot \left( 1-\frac{1}{1+e^{-\theta ^Tx}} \right) \right] \cdot x<br>\<br>&amp;=g\left( \theta ^Tx \right) \cdot \left( 1-g\left( \theta ^Tx \right) \right) \cdot x<br>    \end{aligned}<br>\end{equation}</p>
<p>We plug back this portion to the gradient of cost function (1), </p>
<p>\begin{equation}<br>    \begin{aligned}<br>\frac{\partial}{\partial \theta <em>j}J\left( \theta \right) &amp;=-\frac{1}{m}\left[ \sum</em>{i=1}^m{\left( y^{\left( i \right)}\cdot \frac{1}{g\left( \theta ^Tx \right)}-\left( 1-y^{\left( i \right)} \right) \cdot \frac{1}{1-g\left( \theta ^Tx \right)} \right)}\cdot g\left( \theta ^Tx \right) \cdot \left( 1-g\left( \theta ^Tx \right) \right) \cdot x^{\left( i \right)} \right]<br>\<br>&amp;=-\frac{1}{m}\left[ \sum<em>{i=1}^m{\left[ y^{\left( i \right)}\cdot \left( 1-g\left( \theta ^Tx \right) \right) \cdot x^{\left( i \right)}-\left( 1-y^{\left( i \right)} \right) \cdot g\left( \theta ^Tx \right) \cdot x^{\left( i \right)} \right]} \right]<br>\<br>&amp;=-\frac{1}{m}\sum</em>{i=1}^m{\left[ y^{\left( i \right)}\cdot x^{\left( i \right)}-y^{\left( i \right)}\cdot g\left( \theta ^Tx \right) \cdot x^{\left( i \right)}-g\left( \theta ^Tx \right) \cdot x^{\left( i \right)}+y^{\left( i \right)}\cdot g\left( \theta ^Tx \right) \cdot x^{\left( i \right)} \right]}<br>\<br>&amp;\mathrm{because}-y^{\left( i \right)}\cdot g\left( \theta ^Tx \right) \cdot x^{\left( i \right)}\,\,\mathrm{offsets} +y^{\left( i \right)}\cdot g\left( \theta ^Tx \right) \cdot x^{\left( i \right)}<br>\<br>&amp;=-\frac{1}{m}\sum<em>{i=1}^m{\left[ y^{\left( i \right)}\cdot x^{\left( i \right)}-g\left( \theta ^Tx \right) \cdot x^{\left( i \right)} \right]}<br>\<br>&amp;=-\frac{1}{m}\sum</em>{i=1}^m{\left[ \left[ y^{\left( i \right)}-g\left( \theta ^Tx \right) \right] \cdot x^{\left( i \right)} \right]}<br>\<br>&amp;=\frac{1}{m}\sum<em>{i=1}^m{\left[ \left[ h</em>{\theta}\left( x^{\left( i \right)} \right) -y^{\left( i \right)} \right] \cdot x^{\left( i \right)} \right]}<br>  \end{aligned}<br>\end{equation}</p>
<p>which is the same as linear regression’s </p>
<p>Q.E.D.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/Stokes-Theorem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Stokes-Theorem/" class="post-title-link" itemprop="url">Stokes_Theorem</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-07-20 15:20:42 / Modified: 19:04:41" itemprop="dateCreated datePublished" datetime="2022-07-20T15:20:42+08:00">2022-07-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>In my second semester of High School Junior year, when we were studying vector calculus @Calculus 3,  our teacher gave us an assignment: proof of Stokes formula. CALCULUS EARLY TRANSCENDENTALS EIGHTH EDITION JAMES STEWART (our Calculus3 textbook) only has a special form of stokes’ theorem proof. Thus, I looked up the prood at old Chinese Text Book. It is a pity that our high school calculus education with American calculus education are quite different compared to Chinese’s. I searched on zhihu, Bilibili and other public platforms, but failed to find any suitable results. Luckily, I finally figure it out when I went back home during the epidemic.</p>
<h3 id="Stoke’s-Theorem"><a href="#Stoke’s-Theorem" class="headerlink" title="Stoke’s Theorem"></a>Stoke’s Theorem</h3><p>For surface S in $R^3$ space is an oriented surface in $x,y,z$ coordinate with boundary $\partial S$. Let $R$ be abounded, open region in $s, t$ plane with smooth boundary $\partial R$ . Suppose that $F$ is a continuously differentiable vector field. $\vec{r}$ is a smooth parametrization that maps $R$ to $S$, and $\partial R$ to $\partial S$. Then</p>
<script type="math/tex; mode=display">
\iint_S{curl\,\,\vec{F}\,\,·\,\,d\vec{S}}=\iint_S{\left( \nabla \times \vec{F} \right) \,\,·\,\,\vec{n}\,\,dS}=\int_{\partial S}{\vec{F}\,\,·\,\,\vec{T}\,\,ds}=\,\,\int_{\partial S}{\vec{F}\,\,·\,\,d\vec{r}}</script><p><img src="/img/stks.png" alt="stks"></p>
<h3 id="Proof"><a href="#Proof" class="headerlink" title="Proof"></a>Proof</h3><p>Let</p>
<script type="math/tex; mode=display">
\vec{r}\left( s,t \right) =\left[ \begin{array}{c}
    x\left( s,t \right)\\
    y\left( s,t \right)\\
    z\left( s,t \right)\\
\end{array} \right] \,\,: R\rightarrow S.</script><p>Then.</p>
<script type="math/tex; mode=display">
d\vec{r}\mid_{\partial R}^{}\,\,=\left[ \begin{matrix}
    \frac{\partial x}{\partial s}&        \frac{\partial x}{\partial t}\\
    \frac{\partial y}{\partial s}&        \frac{\partial y}{\partial t}\\
    \frac{\partial z}{\partial s}&        \frac{\partial z}{\partial t}\\
\end{matrix} \right] \left[ \begin{array}{c}
    ds\\
    dt\\
\end{array} \right] \,\,=\left[ \begin{array}{c}
    \frac{\partial x}{\partial s}ds+\frac{\partial x}{\partial t}dt\\
    \frac{\partial y}{\partial s}ds+\frac{\partial y}{\partial t}dt\\
    \frac{\partial z}{\partial s}ds+\frac{\partial z}{\partial t}dt\\
\end{array} \right] \,\,=\left[ \begin{array}{c}
    \frac{\partial x}{\partial s}\\
    \frac{\partial y}{\partial s}\\
    \frac{\partial z}{\partial s}\\
\end{array} \right] ds+\left[ \begin{array}{c}
    \frac{\partial x}{\partial t}\\
    \frac{\partial y}{\partial t}\\
    \frac{\partial z}{\partial t}\\
\end{array} \right] dt\,\,=\frac{\partial \vec{r}}{\partial s}ds+\frac{\partial \vec{r}}{\partial t}dt</script><p>Hence.</p>
<script type="math/tex; mode=display">
\int_{\partial S}{\vec{F}·}d\vec{r}=\int_{\partial S}{\left( \vec{F}·\frac{\partial \vec{r}}{\partial s}ds+\vec{F}·\frac{\partial \vec{r}}{\partial s} \right)}</script><p>We define a 2-dimensional vector field $G=(G1,G2)$ on the s,t, plane by</p>
<script type="math/tex; mode=display">
G_1=\vec{F}\,\,·\,\,\frac{\partial \vec{r}}{\partial s}\,\,  and\,\,  G_2=\vec{F}\,\,·\,\,\frac{\partial \vec{r}}{\partial t}</script><p>Therefore, we put G into the original line integral</p>
<script type="math/tex; mode=display">
\int_{\partial S}{\vec{F}\,\,·\,\,d\vec{r}=}\int_{\partial R}{\left( G_1ds+G_2dt \right) =\int_R{\begin{array}{c}
    \left( \frac{\partial G_2}{\partial s}-\frac{\partial G_1}{\partial t} \right) dsdt\,\,,\\
\end{array}}\,\,}</script><script type="math/tex; mode=display">
\int_{\partial S}{\vec{F}\,\,·\,\,d\vec{r}=}\int_{\partial R}{\left( G_1ds+G_2dt \right) \,\,}</script><p>On the other hand. </p>
<script type="math/tex; mode=display">
\iint_S{curl\,\,\vec{F}\,\,·\,\,d\vec{S}\,\,=\,\,\iint_R{curl\,\,\vec{F}\mid_{\vec{r}}^{}·\frac{\partial \vec{r}}{\partial s}\times \frac{\partial \vec{r}}{\partial t}dsdt}}</script><p>We expand it, get</p>
<script type="math/tex; mode=display">
curl\,\,\vec{F}\mid_{\vec{r}}^{}\cdot \frac{\partial \vec{r}}{\partial s}\times \frac{\partial \vec{r}}{\partial t}\,\,=\,\,\left| \begin{matrix}
    \frac{\partial F_3}{\partial y}-\frac{\partial F_2}{\partial z}&        \frac{\partial F_1}{\partial z}-\frac{\partial F_3}{\partial x}&        \frac{\partial F_2}{\partial x}-\frac{\partial F_1}{\partial y}\\
    \frac{\partial x}{\partial s}&        \frac{\partial y}{\partial s}&        \frac{\partial z}{\partial s}\\
    \frac{\partial x}{\partial t}&        \frac{\partial y}{\partial t}&        \frac{\partial z}{\partial t}\\
\end{matrix} \right|</script><script type="math/tex; mode=display">
=\frac{\partial \vec{F}}{\partial s}·\frac{\partial \vec{r}}{\partial t}-\frac{\partial \vec{F}}{\partial t}·\frac{\partial \vec{r}}{\partial s}\,\,=\frac{\partial G_2}{\partial s}-\frac{\partial G_1}{\partial t}</script><p>Hence.</p>
<script type="math/tex; mode=display">
\int_R{curl\,\,F\mid_{\vec{r}}^{}\cdot \frac{\partial \vec{r}}{\partial s}}\times \frac{\partial \vec{r}}{\partial t}\,\,dsdt\,\,=\,\,\int_R{\begin{array}{c}
    \left( \frac{\partial G_2}{\partial s}-\frac{\partial G_1}{\partial t} \right) dsdt\,\,\\
\end{array}}</script><p>For the line integral part,we have</p>
<script type="math/tex; mode=display">
\int_{\partial S}{\vec{F}\,\,·\,\,d\vec{r}=}\int_{\partial R}{\begin{array}{c}
    \left( G_1ds+G_2dt \right) \,\,\\
\end{array}}</script><p>Use Green’s Theorem, we know</p>
<script type="math/tex; mode=display">
\int_{\partial R}{\begin{array}{c}
    \left( G_1ds+G_2dt \right)\\
\end{array}}=\int_R{\begin{array}{c}
    \left( \frac{\partial G_2}{\partial s}-\frac{\partial G_1}{\partial t} \right) dsdt\,\,,\\
\end{array}}</script><p>So, we can conclude that </p>
<script type="math/tex; mode=display">
\int_{\partial S}{\vec{F}·}d\vec{r}=\int_R{\begin{array}{c}
    \left( \frac{\partial G_2}{\partial s}-\frac{\partial G_1}{\partial t} \right) dsdt=\int_R{curl\,\,F\mid_{\vec{r}}^{}\cdot \frac{\partial \vec{r}}{\partial s}}\times \frac{\partial \vec{r}}{\partial t}\\
\end{array}}dsdt=\iint_S{curl\,\,F\,\,·\,\,d\vec{S}}</script><p>Thus, we finished our proof of Stokes’ Theorem. </p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Stokes-Theorem/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/ML-ex1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/ML-ex1/" class="post-title-link" itemprop="url">ML_ex1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-18 14:50:54" itemprop="dateCreated datePublished" datetime="2022-03-18T14:50:54+08:00">2022-03-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-07-20 17:26:37" itemprop="dateModified" datetime="2022-07-20T17:26:37+08:00">2022-07-20</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Machine-Learning-By-Andrew-Ng"><a href="#Machine-Learning-By-Andrew-Ng" class="headerlink" title="Machine Learning By Andrew Ng"></a>Machine Learning By Andrew Ng</h3><h4 id="Content"><a href="#Content" class="headerlink" title="Content"></a>Content</h4><ul>
<li>Introduction</li>
<li>Potential Submit Problem</li>
<li>ex1.m</li>
<li>computerCost.m</li>
<li>gradientDescent.m</li>
<li>ex1_multi.m</li>
<li>featureNormalize.m</li>
<li>computeCostMulti.m</li>
<li>gradientDescentMulti.m</li>
<li>normalEqn.m</li>
</ul>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><p>I have listened for so many times that the course: Machine Learning by Andrew Ng is one of the best introductory course for machine learning.<br>Now, I have finished the first two week’s classed and pass the first programming project. I truly fathom out the deliberate design of this course. The passion and meticulous designed project impress me as well. It is so particular that I feel like someone is teaching me hand-by-hand.<br>Coursera uses a kind of judging method which is not like the common OJ that you upload your program and they run it and test it with their test data. Coursera uses an aggregate local submit module that can do all the stuff. You just need to generate a token that linked to your coursera account so that it can upload your progress. It is so cooooool!!!!!!<br> <img src="/img/ML/ex1/f1.png" alt="f1"><br> <img src="/img/ML/ex1/f2.png" alt="f2"></p>
<h5 id="Potential-Submit-Problem"><a href="#Potential-Submit-Problem" class="headerlink" title="Potential Submit Problem"></a>Potential Submit Problem</h5><p>Once I tried to submit the program, it says<br><img src="/img/ML/ex1/d1.png" alt="d1"><br>According to <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44498043/article/details/105904715">https://blog.csdn.net/qq_44498043/article/details/105904715</a> and <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45923568/article/details/104193579">https://blog.csdn.net/weixin_45923568/article/details/104193579</a> , I found out that the error is caused by the vulnerable grammar that it used before. And in the latest version of matlab, matlab banned those kinds of grammar in order to increase the stability. So all we need is to go to the coursera website and download the new version of submit module. </p>
<h4 id="ex1-m"><a href="#ex1-m" class="headerlink" title="ex1.m"></a>ex1.m</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%% Initialization</span>
clear <span class="token punctuation">;</span> close all<span class="token punctuation">;</span> clc

<span class="token comment">%% ==================== Part 1: Basic Function ====================</span>
<span class="token comment">% Complete warmUpExercise.m</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Running warmUpExercise ... \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'5x5 Identity Matrix: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">warmUpExercise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% ======================= Part 2: Plotting =======================</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Plotting Data ...\n'</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'ex1data1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% number of training examples</span>

<span class="token comment">% Plot Data</span>
<span class="token comment">% Note: You have to complete the code in plotData.m</span>
<span class="token function">plotData</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% =================== Part 3: Cost and Gradient descent ===================</span>

X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% Add a column of ones to x</span>
theta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% initialize fitting parameters</span>

<span class="token comment">% Some gradient descent settings</span>
iterations <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">;</span>
alpha <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\nTesting the cost function ...\n'</span><span class="token punctuation">)</span>
<span class="token comment">% compute and display initial cost</span>
J <span class="token operator">=</span> <span class="token function">computeCost</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'With theta = [0 ; 0]\nCost computed = %f\n'</span><span class="token punctuation">,</span> J<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Expected cost value (approx) 32.07\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% further testing of the cost function</span>
J <span class="token operator">=</span> <span class="token function">computeCost</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\nWith theta = [-1 ; 2]\nCost computed = %f\n'</span><span class="token punctuation">,</span> J<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Expected cost value (approx) 54.24\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\nRunning Gradient Descent ...\n'</span><span class="token punctuation">)</span>
<span class="token comment">% run gradient descent</span>
theta <span class="token operator">=</span> <span class="token function">gradientDescent</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> iterations<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% print theta to screen</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta found by gradient descent:\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'%f\n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Expected theta values (approx)\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' -3.6303\n  1.1664\n\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Plot the linear fit</span>
hold on<span class="token punctuation">;</span> <span class="token comment">% keep previous plot visible</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token operator">*</span>theta<span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'Training data'</span><span class="token punctuation">,</span> <span class="token string">'Linear regression'</span><span class="token punctuation">)</span>
hold off <span class="token comment">% don't overlay any more plots on this figure</span>

<span class="token comment">% Predict values for population sizes of 35,000 and 70,000</span>
predict1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3.5</span><span class="token punctuation">]</span> <span class="token operator">*</span>theta<span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'For population = 35,000, we predict a profit of %f\n'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    predict1<span class="token operator">*</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
predict2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> theta<span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'For population = 70,000, we predict a profit of %f\n'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    predict2<span class="token operator">*</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% ============= Part 4: Visualizing J(theta_0, theta_1) =============</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Visualizing J(theta_0, theta_1) ...\n'</span><span class="token punctuation">)</span>

<span class="token comment">% Grid over which we will calculate J</span>
theta0_vals <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
theta1_vals <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% initialize J_vals to a matrix of 0's</span>
J_vals <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>theta0_vals<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">length</span><span class="token punctuation">(</span>theta1_vals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Fill out J_vals</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>theta0_vals<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token number">j</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>theta1_vals<span class="token punctuation">)</span>
	  t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">theta0_vals</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">theta1_vals</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	  <span class="token function">J_vals</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">computeCost</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">% Because of the way meshgrids work in the surf command, we need to</span>
<span class="token comment">% transpose J_vals before calling surf, or else the axes will be flipped</span>
J_vals <span class="token operator">=</span> J_vals<span class="token operator">'</span><span class="token punctuation">;</span>
<span class="token comment">% Surface plot</span>
figure<span class="token punctuation">;</span>
<span class="token function">surf</span><span class="token punctuation">(</span>theta0_vals<span class="token punctuation">,</span> theta1_vals<span class="token punctuation">,</span> J_vals<span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'\theta_0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'\theta_1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Contour plot</span>
figure<span class="token punctuation">;</span>
<span class="token comment">% Plot J_vals as 15 contours spaced logarithmically between 0.01 and 100</span>
<span class="token function">contour</span><span class="token punctuation">(</span>theta0_vals<span class="token punctuation">,</span> theta1_vals<span class="token punctuation">,</span> J_vals<span class="token punctuation">,</span> <span class="token function">logspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'\theta_0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'\theta_1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">theta</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">theta</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'rx'</span><span class="token punctuation">,</span> <span class="token string">'MarkerSize'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="computerCost-m"><a href="#computerCost-m" class="headerlink" title="computerCost.m"></a>computerCost.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> J <span class="token operator">=</span> <span class="token function">computeCost</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span>
<span class="token comment">%COMPUTECOST Compute cost for linear regression</span>
<span class="token comment">%   J = COMPUTECOST(X, y, theta) computes the cost of using theta as the</span>
<span class="token comment">%   parameter for linear regression to fit the data points in X and y</span>

<span class="token comment">% Initialize some useful values</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% number of training examples</span>

<span class="token comment">% You need to return the following variables correctly </span>
J <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: Compute the cost of a particular choice of theta</span>
<span class="token comment">%               You should set J to the cost.</span>
X_pd<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X_pd<span class="token operator">=</span>X<span class="token operator">*</span>theta<span class="token punctuation">;</span>
J<span class="token operator">=</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">-</span>X_pd<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
J<span class="token operator">=</span>J<span class="token operator">./</span><span class="token punctuation">(</span><span class="token number">2.</span><span class="token operator">*</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% =========================================================================</span>

<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="gradientDescent-m"><a href="#gradientDescent-m" class="headerlink" title="gradientDescent.m"></a>gradientDescent.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>theta<span class="token punctuation">,</span> J_history<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gradientDescent</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> num_iters<span class="token punctuation">)</span>
<span class="token comment">%GRADIENTDESCENT Performs gradient descent to learn theta</span>
<span class="token comment">%   theta = GRADIENTDESCENT(X, y, theta, alpha, num_iters) updates theta by </span>
<span class="token comment">%   taking num_iters gradient steps with learning rate alpha</span>

<span class="token comment">% Initialize some useful values</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% number of training examples</span>
J_history <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num_iters<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> iter <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>num_iters

    <span class="token comment">% ====================== YOUR CODE HERE ======================</span>
    <span class="token comment">% Instructions: Perform a single gradient step on the parameter vector</span>
    <span class="token comment">%               theta. </span>
    %
    <span class="token comment">% Hint: While debugging, it can be useful to print out the values</span>
    <span class="token comment">%       of the cost function (computeCost) and gradient here.</span>
    %

    theta<span class="token operator">=</span>theta<span class="token operator">-</span>alpha<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>m<span class="token punctuation">)</span><span class="token operator">*</span>X<span class="token operator">'</span><span class="token operator">*</span><span class="token punctuation">(</span>X<span class="token operator">*</span>theta<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">% ============================================================</span>

    <span class="token comment">% Save the cost J in every iteration    </span>
    <span class="token function">J_history</span><span class="token punctuation">(</span>iter<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">computeCost</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> <img src="/img/ML/ex1/f3.png" alt="f3"><br> <img src="/img/ML/ex1/suc1.png" alt="suc1"></p>
<h5 id="ex1-multi-m"><a href="#ex1-multi-m" class="headerlink" title="ex1_multi.m"></a>ex1_multi.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%% ================ Part 1: Feature Normalization ================</span>

<span class="token comment">%% Clear and Close Figures</span>
clear <span class="token punctuation">;</span> close all<span class="token punctuation">;</span> clc

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Loading data ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Print out some data points</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'First 10 examples from the dataset: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' x = [%.0f %.0f], y = %.0f \n'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">% Scale features and set them to zero mean</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Normalizing Features ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>X mu sigma<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">featureNormalize</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">%% ================ Part 2: Gradient Descent ================</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: We have provided you with the following starter</span>
<span class="token comment">%               code that runs gradient descent with a particular</span>
<span class="token comment">%               learning rate (alpha). </span>
%
<span class="token comment">%               Your task is to first make sure that your functions - </span>
<span class="token comment">%               computeCost and gradientDescent already work with </span>
<span class="token comment">%               this starter code and support multiple variables.</span>
%
<span class="token comment">%               After that, try running gradient descent with </span>
<span class="token comment">%               different values of alpha and see which one gives</span>
<span class="token comment">%               you the best result.</span>
%
<span class="token comment">%               Finally, you should complete the code at the end</span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%
<span class="token comment">% Hint: By using the 'hold on' command, you can plot multiple</span>
<span class="token comment">%       graphs on the same figure.</span>
%
<span class="token comment">% Hint: At prediction, make sure you do the same feature normalization.</span>
%

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Running gradient descent ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Choose some alpha value</span>
alpha <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
num_iters <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>

<span class="token comment">% Init Theta and Run Gradient Descent </span>
theta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>theta<span class="token punctuation">,</span> J_history<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gradientDescentMulti</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> num_iters<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Plot the convergence graph</span>
figure<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">numel</span><span class="token punctuation">(</span>J_history<span class="token punctuation">)</span><span class="token punctuation">,</span> J_history<span class="token punctuation">,</span> <span class="token string">'-b'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Number of iterations'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Cost J'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display gradient descent's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from gradient descent: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Recall that the first column of X is all-ones. Thus, it does</span>
<span class="token comment">% not need to be normalized.</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>
X_test1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

price<span class="token operator">=</span>X_test1<span class="token operator">*</span>theta<span class="token punctuation">;</span>

<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using gradient descent):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% ================ Part 3: Normal Equations ================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Solving with normal equations...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: The following code computes the closed form </span>
<span class="token comment">%               solution for linear regression using the normal</span>
<span class="token comment">%               equations. You should complete the code in </span>
<span class="token comment">%               normalEqn.m</span>
%
<span class="token comment">%               After doing so, you should complete this code </span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">csvread</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">% Calculate the parameters from the normal equation</span>
theta <span class="token operator">=</span> <span class="token function">normalEqn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display normal equation's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from the normal equations: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>

X_test2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
price<span class="token operator">=</span>X_test2<span class="token operator">*</span>theta<span class="token punctuation">;</span>
<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using normal equations):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="featureNormalize-m"><a href="#featureNormalize-m" class="headerlink" title="featureNormalize.m"></a>featureNormalize.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%% ================ Part 1: Feature Normalization ================</span>

<span class="token comment">%% Clear and Close Figures</span>
clear <span class="token punctuation">;</span> close all<span class="token punctuation">;</span> clc

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Loading data ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Print out some data points</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'First 10 examples from the dataset: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' x = [%.0f %.0f], y = %.0f \n'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">% Scale features and set them to zero mean</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Normalizing Features ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>X mu sigma<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">featureNormalize</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">%% ================ Part 2: Gradient Descent ================</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: We have provided you with the following starter</span>
<span class="token comment">%               code that runs gradient descent with a particular</span>
<span class="token comment">%               learning rate (alpha). </span>
%
<span class="token comment">%               Your task is to first make sure that your functions - </span>
<span class="token comment">%               computeCost and gradientDescent already work with </span>
<span class="token comment">%               this starter code and support multiple variables.</span>
%
<span class="token comment">%               After that, try running gradient descent with </span>
<span class="token comment">%               different values of alpha and see which one gives</span>
<span class="token comment">%               you the best result.</span>
%
<span class="token comment">%               Finally, you should complete the code at the end</span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%
<span class="token comment">% Hint: By using the 'hold on' command, you can plot multiple</span>
<span class="token comment">%       graphs on the same figure.</span>
%
<span class="token comment">% Hint: At prediction, make sure you do the same feature normalization.</span>
%

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Running gradient descent ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Choose some alpha value</span>
alpha <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
num_iters <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>

<span class="token comment">% Init Theta and Run Gradient Descent </span>
theta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>theta<span class="token punctuation">,</span> J_history<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gradientDescentMulti</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> num_iters<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Plot the convergence graph</span>
figure<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">numel</span><span class="token punctuation">(</span>J_history<span class="token punctuation">)</span><span class="token punctuation">,</span> J_history<span class="token punctuation">,</span> <span class="token string">'-b'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Number of iterations'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Cost J'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display gradient descent's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from gradient descent: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Recall that the first column of X is all-ones. Thus, it does</span>
<span class="token comment">% not need to be normalized.</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>
X_test1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

price<span class="token operator">=</span>X_test1<span class="token operator">*</span>theta<span class="token punctuation">;</span>

<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using gradient descent):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% ================ Part 3: Normal Equations ================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Solving with normal equations...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: The following code computes the closed form </span>
<span class="token comment">%               solution for linear regression using the normal</span>
<span class="token comment">%               equations. You should complete the code in </span>
<span class="token comment">%               normalEqn.m</span>
%
<span class="token comment">%               After doing so, you should complete this code </span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">csvread</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">% Calculate the parameters from the normal equation</span>
theta <span class="token operator">=</span> <span class="token function">normalEqn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display normal equation's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from the normal equations: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>

X_test2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
price<span class="token operator">=</span>X_test2<span class="token operator">*</span>theta<span class="token punctuation">;</span>
<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using normal equations):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="computeCostMulti-m"><a href="#computeCostMulti-m" class="headerlink" title="computeCostMulti.m"></a>computeCostMulti.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%% ================ Part 1: Feature Normalization ================</span>

<span class="token comment">%% Clear and Close Figures</span>
clear <span class="token punctuation">;</span> close all<span class="token punctuation">;</span> clc

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Loading data ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Print out some data points</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'First 10 examples from the dataset: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' x = [%.0f %.0f], y = %.0f \n'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">% Scale features and set them to zero mean</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Normalizing Features ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>X mu sigma<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">featureNormalize</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">%% ================ Part 2: Gradient Descent ================</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: We have provided you with the following starter</span>
<span class="token comment">%               code that runs gradient descent with a particular</span>
<span class="token comment">%               learning rate (alpha). </span>
%
<span class="token comment">%               Your task is to first make sure that your functions - </span>
<span class="token comment">%               computeCost and gradientDescent already work with </span>
<span class="token comment">%               this starter code and support multiple variables.</span>
%
<span class="token comment">%               After that, try running gradient descent with </span>
<span class="token comment">%               different values of alpha and see which one gives</span>
<span class="token comment">%               you the best result.</span>
%
<span class="token comment">%               Finally, you should complete the code at the end</span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%
<span class="token comment">% Hint: By using the 'hold on' command, you can plot multiple</span>
<span class="token comment">%       graphs on the same figure.</span>
%
<span class="token comment">% Hint: At prediction, make sure you do the same feature normalization.</span>
%

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Running gradient descent ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Choose some alpha value</span>
alpha <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
num_iters <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>

<span class="token comment">% Init Theta and Run Gradient Descent </span>
theta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>theta<span class="token punctuation">,</span> J_history<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gradientDescentMulti</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> num_iters<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Plot the convergence graph</span>
figure<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">numel</span><span class="token punctuation">(</span>J_history<span class="token punctuation">)</span><span class="token punctuation">,</span> J_history<span class="token punctuation">,</span> <span class="token string">'-b'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Number of iterations'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Cost J'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display gradient descent's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from gradient descent: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Recall that the first column of X is all-ones. Thus, it does</span>
<span class="token comment">% not need to be normalized.</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>
X_test1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

price<span class="token operator">=</span>X_test1<span class="token operator">*</span>theta<span class="token punctuation">;</span>

<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using gradient descent):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% ================ Part 3: Normal Equations ================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Solving with normal equations...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: The following code computes the closed form </span>
<span class="token comment">%               solution for linear regression using the normal</span>
<span class="token comment">%               equations. You should complete the code in </span>
<span class="token comment">%               normalEqn.m</span>
%
<span class="token comment">%               After doing so, you should complete this code </span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">csvread</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">% Calculate the parameters from the normal equation</span>
theta <span class="token operator">=</span> <span class="token function">normalEqn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display normal equation's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from the normal equations: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>

X_test2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
price<span class="token operator">=</span>X_test2<span class="token operator">*</span>theta<span class="token punctuation">;</span>
<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using normal equations):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="gradientDescentMulti-m"><a href="#gradientDescentMulti-m" class="headerlink" title="gradientDescentMulti.m"></a>gradientDescentMulti.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%% ================ Part 1: Feature Normalization ================</span>

<span class="token comment">%% Clear and Close Figures</span>
clear <span class="token punctuation">;</span> close all<span class="token punctuation">;</span> clc

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Loading data ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Print out some data points</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'First 10 examples from the dataset: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' x = [%.0f %.0f], y = %.0f \n'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">% Scale features and set them to zero mean</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Normalizing Features ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>X mu sigma<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">featureNormalize</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token comment">%% ================ Part 2: Gradient Descent ================</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: We have provided you with the following starter</span>
<span class="token comment">%               code that runs gradient descent with a particular</span>
<span class="token comment">%               learning rate (alpha). </span>
%
<span class="token comment">%               Your task is to first make sure that your functions - </span>
<span class="token comment">%               computeCost and gradientDescent already work with </span>
<span class="token comment">%               this starter code and support multiple variables.</span>
%
<span class="token comment">%               After that, try running gradient descent with </span>
<span class="token comment">%               different values of alpha and see which one gives</span>
<span class="token comment">%               you the best result.</span>
%
<span class="token comment">%               Finally, you should complete the code at the end</span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%
<span class="token comment">% Hint: By using the 'hold on' command, you can plot multiple</span>
<span class="token comment">%       graphs on the same figure.</span>
%
<span class="token comment">% Hint: At prediction, make sure you do the same feature normalization.</span>
%

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Running gradient descent ...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Choose some alpha value</span>
alpha <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
num_iters <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>

<span class="token comment">% Init Theta and Run Gradient Descent </span>
theta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>theta<span class="token punctuation">,</span> J_history<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gradientDescentMulti</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> num_iters<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Plot the convergence graph</span>
figure<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">numel</span><span class="token punctuation">(</span>J_history<span class="token punctuation">)</span><span class="token punctuation">,</span> J_history<span class="token punctuation">,</span> <span class="token string">'-b'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Number of iterations'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Cost J'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display gradient descent's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from gradient descent: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Recall that the first column of X is all-ones. Thus, it does</span>
<span class="token comment">% not need to be normalized.</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>
X_test1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

price<span class="token operator">=</span>X_test1<span class="token operator">*</span>theta<span class="token punctuation">;</span>

<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using gradient descent):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Program paused. Press enter to continue.\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">pause</span><span class="token punctuation">;</span>

<span class="token comment">%% ================ Part 3: Normal Equations ================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Solving with normal equations...\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: The following code computes the closed form </span>
<span class="token comment">%               solution for linear regression using the normal</span>
<span class="token comment">%               equations. You should complete the code in </span>
<span class="token comment">%               normalEqn.m</span>
%
<span class="token comment">%               After doing so, you should complete this code </span>
<span class="token comment">%               to predict the price of a 1650 sq-ft, 3 br house.</span>
%

<span class="token comment">%% Load Data</span>
data <span class="token operator">=</span> <span class="token function">csvread</span><span class="token punctuation">(</span><span class="token string">'ex1data2.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Add intercept term to X</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">ones</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">% Calculate the parameters from the normal equation</span>
theta <span class="token operator">=</span> <span class="token function">normalEqn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Display normal equation's result</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Theta computed from the normal equations: \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' %f \n'</span><span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">% Estimate the price of a 1650 sq-ft, 3 br house</span>
<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">% You should change this</span>

X_test2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1650</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span><span class="token function">mu</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">sigma</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
price<span class="token operator">=</span>X_test2<span class="token operator">*</span>theta<span class="token punctuation">;</span>
<span class="token comment">% ============================================================</span>

<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Predicted price of a 1650 sq-ft, 3 br house '</span> <span class="token punctuation">...</span>
         <span class="token string">'(using normal equations):\n $%f\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="normalEqn-m"><a href="#normalEqn-m" class="headerlink" title="normalEqn.m"></a>normalEqn.m</h5><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>theta<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">normalEqn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment">%NORMALEQN Computes the closed-form solution to linear regression </span>
<span class="token comment">%   NORMALEQN(X,y) computes the closed-form solution to linear </span>
<span class="token comment">%   regression using the normal equations.</span>

theta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% ====================== YOUR CODE HERE ======================</span>
<span class="token comment">% Instructions: Complete the code to compute the closed form solution</span>
<span class="token comment">%               to linear regression and put the result in theta.</span>
%

<span class="token comment">% ---------------------- Sample Solution ----------------------</span>



theta <span class="token operator">=</span> <span class="token function">pinv</span><span class="token punctuation">(</span><span class="token function">transpose</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">*</span>X<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">transpose</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">*</span>y<span class="token punctuation">;</span>

<span class="token comment">% -------------------------------------------------------------</span>


<span class="token comment">% ============================================================</span>

<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> <img src="/img/ML/ex1/mul.png" alt="mul"><br> <img src="/img/ML/ex1/suc2.png" alt="suc2"><br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/ML-ex1/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/OIO001/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/OIO001/" class="post-title-link" itemprop="url">OIO001</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-24 08:27:07 / Modified: 08:49:09" itemprop="dateCreated datePublished" datetime="2022-02-24T08:27:07+08:00">2022-02-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>I am afraid of being a simp of her, not because I don’t love her but because I love her so deeply that I can’t afford the cost of losing the unparalleledly and weakly existing relationship with her. </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/D220223/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/D220223/" class="post-title-link" itemprop="url">D220223</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-23 21:57:43 / Modified: 22:02:42" itemprop="dateCreated datePublished" datetime="2022-02-23T21:57:43+08:00">2022-02-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>忽然发现在学校这种全天学习，学和放松娱乐整合成一个整体的状态非常高效且舒适。总而言之就是一直在学并且放松，从早上一直到睡觉，并不像有些人想的那样，什么时候到什么时候全学，然后开始玩知道睡觉，我觉得这种学习时间的分隔感会降低学习效率。<br>此外，在看了那么多北师大实验国际部的申请成功案例之后，我终于意识到了一个事情，就是实验人均一个各种各样的科研，这才是他们成功的关键。<br>爱一个人却不敢接近，并不是因为爱得不够深；而是因为爱的足够深从而害怕失去这易碎且美好的挂念。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/OPCV000/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/OPCV000/" class="post-title-link" itemprop="url">OPCV000</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-22 12:45:25 / Modified: 17:24:34" itemprop="dateCreated datePublished" datetime="2022-02-22T12:45:25+08:00">2022-02-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Introduction-to-OpenCV"><a href="#Introduction-to-OpenCV" class="headerlink" title="Introduction to OpenCV"></a>Introduction to OpenCV</h2><h3 id="Content"><a href="#Content" class="headerlink" title="Content"></a>Content</h3><ul>
<li>Introduction</li>
<li>Code</li>
<li>Demo</li>
</ul>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><p>An interesting “Hello World” in OpenCV. It invokes the camera and recognizes hands. Then, it uses the coordinates of these nodes in hands to draw the real time hands frameworks.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><p>Here comes the code:<br><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> mediapipe <span class="token keyword">as</span> mp



cap<span class="token operator">=</span>cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

mpHands<span class="token operator">=</span> mp<span class="token punctuation">.</span>solutions<span class="token punctuation">.</span>hands
hands <span class="token operator">=</span> mpHands<span class="token punctuation">.</span>Hands<span class="token punctuation">(</span><span class="token punctuation">)</span>

mpDraw<span class="token operator">=</span> mp<span class="token punctuation">.</span>solutions<span class="token punctuation">.</span>drawing_utils

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    ret<span class="token punctuation">,</span> img <span class="token operator">=</span>cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ret<span class="token punctuation">:</span> 
        imgRGB<span class="token operator">=</span>cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>
        result<span class="token operator">=</span>hands<span class="token punctuation">.</span>process<span class="token punctuation">(</span>imgRGB<span class="token punctuation">)</span>
        <span class="token comment">#print(result.multi_hand_landmarks)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">.</span>multi_hand_landmarks<span class="token punctuation">:</span>
            <span class="token keyword">for</span> handLms <span class="token keyword">in</span> result<span class="token punctuation">.</span>multi_hand_landmarks<span class="token punctuation">:</span>
                mpDraw<span class="token punctuation">.</span>draw_landmarks<span class="token punctuation">(</span>img<span class="token punctuation">,</span>handLms<span class="token punctuation">,</span>mpHands<span class="token punctuation">.</span>HAND_CONNECTIONS<span class="token punctuation">)</span>
        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span>img<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h4 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h4><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1w44y1j7y3">https://www.bilibili.com/video/BV1w44y1j7y3</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/THINK001/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/THINK001/" class="post-title-link" itemprop="url">THINK001</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-18 22:05:53 / Modified: 22:11:46" itemprop="dateCreated datePublished" datetime="2022-02-18T22:05:53+08:00">2022-02-18</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>观Pioneer年度最佳论文们有感。<br>在美本申请领域，人们看起来的强度（指除了GPA以外的，例如标化，水竞赛，活动等等），其实并不像高考一样，纯和你的智力与努力程度成正比。美本申请的这些东西，其实更取决于起步时间。就比如说高一开学的时候，有的人托福115，有的人还没开始学，像托福，ACT，SAT，高中生的那些所谓的”竞赛“，其实并不需要智力和方法，就是看学习时间的长短和积累。而当起步晚的学生们在奋力学标化的时候，那些起步早的人，就可以拿出时间去搞活动，搞竞赛，搞”科研“去了。至于美高学生，那就是起步更早的，所以就，从美本申请的角度来看更成功。<br>所以我想对现在迷茫和焦虑的人说，你虽然感觉自己没有有一些人强，并不是因为你的能力不行，而是你的起步时间太晚了，所以不要担心，美本其实都差不多，本科大家都是一样的，好好学习，最后体现的才是大家真实的实力。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://link-bnds.github.io/D220218/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rin.png">
      <meta itemprop="name" content="Link LZC">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Link LZCのBlog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/D220218/" class="post-title-link" itemprop="url">D220218</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-02-18 21:15:07 / Modified: 21:25:36" itemprop="dateCreated datePublished" datetime="2022-02-18T21:15:07+08:00">2022-02-18</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>啊<br>后天就考托福了<br>不过想想也没必要紧张，反正我要求不高，又不申夏校，只要比之前的拼分高一点就行。</p>
<p>假期还感兴趣了一些别的，比如星际争霸的re-take；日本那个全能房屋改造，看那些现代和风的建筑和装修真的很喜欢，以后一定要想办法多参观这种和风一户建。此外还有戏腔，非传统京剧，虽然是那些流行的比如探窗啊赤玲啥的，但是我觉得挺好听的。</p>
<p>开学了之后就可以开始稍微正常一点，闲适一点了，可惜要一遍刷AP，准备开学考。之后还得一边背ACT单词，一边读要读的Lolita 高堡奇人和历史书了，，。还要想办法抽出时间继续学习ML。。。。啊 还有物理C。。淦了</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Link LZC</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
